<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat — Conversational AI</title>
<style>
  :root{
    --bg:#3b1534;
    --panel:#5a2450;
    --muted:#d9c9dc;
    --pink:#ff2fa6;
    --bubble-left:#e6e0e7;
    --bubble-right:linear-gradient(90deg,#d94aa0,#ff5aa8);
    --white:#ffffff;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--white)}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px;box-sizing:border-box}
  .panel{width:100%;max-width:1000px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));border-radius:8px;padding:24px;box-shadow:0 20px 50px rgba(0,0,0,0.5);display:flex;flex-direction:column;gap:12px;box-sizing:border-box}
  .header{display:flex;align-items:center;justify-content:space-between}
  .title{font-weight:700;letter-spacing:0.6px}
  .chat-area{background:transparent;border-radius:8px;flex:1;display:flex;flex-direction:column;overflow:hidden;min-height:360px}
  .messages{flex:1;overflow:auto;padding:22px 18px;display:flex;flex-direction:column;gap:14px;scroll-behavior:smooth}
  .msg{max-width:72%;padding:12px 16px;border-radius:20px;box-sizing:border-box;line-height:1.2;word-wrap:break-word}
  .left{align-self:flex-start;background:var(--bubble-left);color:#333;border-bottom-left-radius:6px}
  .right{align-self:flex-end;background:var(--bubble-right);color:#fff;border-bottom-right-radius:6px}
  .meta{font-size:12px;color:var(--muted);margin-bottom:6px}
  .composer{display:flex;gap:8px;padding:12px;border-top:1px solid rgba(255,255,255,0.03);align-items:center}
  .input{flex:1;background:rgba(0,0,0,0.15);border-radius:999px;padding:12px 14px;border:0;color:var(--white);outline:none;resize:none;min-height:44px;max-height:120px}
  .btn{background:linear-gradient(90deg,var(--pink),#ff5aa8);border:0;color:#fff;padding:10px 12px;border-radius:999px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
  .hint{font-size:13px;color:var(--muted);text-align:center;margin-top:6px}
  /* small screens */
  @media (max-width:760px){
    .panel{padding:16px}
    .messages{padding:16px}
    .msg{max-width:86%}
  }
</style>
</head>
<body>
  <main class="wrap" role="main" aria-labelledby="chatTitle">
    <section class="panel" aria-labelledby="chatTitle">
      <div class="header">
        <div class="title" id="chatTitle">Chat with Support</div>
        <div style="font-size:13px;color:var(--muted)"><a href="Dashboard.html" style="color:var(--pink);text-decoration:none">Back</a></div>
      </div>

      <div class="chat-area" role="application" aria-live="polite" aria-atomic="false">
        <div id="messages" class="messages" role="list" aria-label="Messages">
          <!-- messages appended here -->
          <div class="msg left" role="listitem">
            <div class="meta">Assistant</div>
            Hello — I'm here to listen. How are you feeling today?
          </div>
        </div>

        <div class="composer" role="region" aria-label="Message composer">
          <textarea id="input" class="input" placeholder="Type something..." rows="1" aria-label="Message"></textarea>
          <button id="send" class="btn" aria-label="Send message" title="Send">
            <!-- send icon -->
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M2 21l21-9L2 3v7l15 2-15 2v7z" fill="#fff"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="hint">Press Enter to send — Shift+Enter for new line</div>
    </section>
  </main>

<script>
  const messagesEl = document.getElementById('messages');
  const inputEl = document.getElementById('input');
  const sendBtn = document.getElementById('send');

  function appendMessage(text, side='right', who = '') {
    const wrap = document.createElement('div');
    wrap.className = `msg ${side}`;
    wrap.setAttribute('role','listitem');
    if (who) {
      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.textContent = who;
      wrap.appendChild(meta);
    }
    const textNode = document.createElement('div');
    textNode.innerHTML = text.replace(/\n/g,'<br>');
    wrap.appendChild(textNode);
    messagesEl.appendChild(wrap);
    messagesEl.scrollTop = messagesEl.scrollHeight;
  }

  function send() {
    const raw = inputEl.value.trim();
    if (!raw) return;
    appendMessage(escapeHtml(raw), 'right', 'You');
    inputEl.value = '';
    inputEl.focus();

    // simple simulated assistant reply (replace with real backend)
    setTimeout(() => {
      const reply = generateReply(raw);
      appendMessage(escapeHtml(reply), 'left', 'Assistant');
    }, 700 + Math.random()*800);
  }

  // very small safe-escape
  function escapeHtml(s) {
    return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  // placeholder reply logic (replace with API call)
  function generateReply(user) {
    const lower = user.toLowerCase();
    if (lower.includes('help') || lower.includes('suicide') || lower.includes('die')) {
      return 'If you are in immediate danger, please call your local emergency number now. If you want, I can show crisis resources.';
    }
    const defaults = [
      "Thanks for sharing. Can you tell me more about that?",
      "I hear you. What happened most recently?",
      "That sounds difficult. How long have you been feeling this way?",
      "I’m here to listen. What would you like to focus on right now?"
    ];
    return defaults[Math.floor(Math.random()*defaults.length)];
  }

  // handlers
  sendBtn.addEventListener('click', send);
  inputEl.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      send();
    }
  });

  // keep textarea height natural
  inputEl.addEventListener('input', () => {
    inputEl.style.height = 'auto';
    inputEl.style.height = Math.min(inputEl.scrollHeight, 140) + 'px';
  });

  // focus
  inputEl.focus();
</script>
</body>
</html>